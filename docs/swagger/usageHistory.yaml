components:
  schemas:
    UsageHistory:
      type: object
      properties:
        dispenserId:
          type: string
          description: ID of the dispenser
          example: "disp_001"
        userId:
          type: string
          description: ID of the user
          example: "user_001"
        day:
          type: string
          description: Day of the week
          example: "Mon"
        date:
          type: string
          format: date-time
          description: Timestamp when the usage occurred
        usage:
          type: number
          description: Amount of water used in liters
          example: 2.8




paths:
  /api/usage-history:
    post:
      summary: Create new usage history record
      tags:
        - Usage History
      description: Create a new usage history record when a user uses a dispenser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - dispenserId
                - userId
                - day
                - usage
              properties:
                dispenserId:
                  type: string
                  description: ID of the dispenser
                  example: "disp_001"
                userId:
                  type: string
                  description: ID of the user
                  example: "user_001"
                day:
                  type: string
                  description: Day of the week
                  example: "Mon"
                usage:
                  type: number
                  description: Amount of water used in liters
                  example: 2.8
      responses:
        '201':
          description: Usage history created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: '#/components/schemas/UsageHistory'
        '400':
          description: Invalid input - missing required fields or invalid usage value
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '404':
          description: Dispenser or user not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    example: "Dispenser with ID 'disp_001' not found"
        '500':
          description: Server error

  /api/usage-history/{dispenserId}:
    get:
      summary: Get usage history by dispenser ID
      tags:
        - Usage History
      description: Retrieve usage history for a specific dispenser
      parameters:
        - in: path
          name: dispenserId
          required: true
          schema:
            type: string
          description: Dispenser ID
        - in: query
          name: limit
          schema:
            type: integer
            default: 10
          description: Maximum number of records to return
          example: 10
      responses:
        '200':
          description: Usage history retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/UsageHistory'
        '404':
          description: Dispenser not found

  /api/usage-history/{dispenserId}/weekly:
    get:
      summary: Get weekly usage history by dispenser ID
      tags:
        - Usage History
      description: Retrieve weekly usage history for a specific dispenser
      parameters:
        - in: path
          name: dispenserId
          required: true
          schema:
            type: string
          description: Dispenser ID
        - in: query
          name: date
          schema:
            type: string
            format: date
          description: Reference date for the week (optional, defaults to today)
          example: "2024-12-25"
      responses:
        '200':
          description: Weekly usage history retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/UsageHistory'
        '404':
          description: Dispenser not found
